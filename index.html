<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DSA with Siddhant</title>
  <link rel="stylesheet" href="monaco-editor/min/vs/editor/editor.main.css">
  <script src="https://unpkg.com/monaco-editor/min/vs/loader.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
  <style>
    /* Smooth transition for the sidebar and icons */
    #sidebar {
      transition: all 0.3s ease;
    }

    /* Hide labels in collapsed mode */
    #sidebar.collapsed .sidebar-label {
      display: none;
    }

    /* Center the icons in collapsed mode */
    #sidebar.collapsed .sidebar-item {
      justify-content: center;
    }

    /* Shrink sidebar width when collapsed */
    #sidebar.collapsed {
      width: 4rem;
    }

    /* Expand sidebar to full width */
    #sidebar.expanded {
      width: 18rem;
    }

    /* Hide children items by default */
    .child-menu {
      display: none;
      margin-left: 2rem;
    }

    /* Show children items when parent is active */
    .parent-active .child-menu {
      display: block;
    }

    /* Add transition effect for child menu items */
    .child-menu {
      transition: all 0.3s ease;
    }

    /* Style for console output */
    #editorOutput {
      white-space: pre-wrap;
    }
  </style>
</head>

<body class="bg-gray-100">

  <div class="flex h-screen">
    <!-- Sidebar -->
    <nav id="sidebar" class="bg-gray-800 text-white h-full flex-shrink-0 p-5 shadow-lg transition-all duration-300 expanded">
      <div class="flex justify-between items-center mb-4">
        <span class="text-xl font-bold sidebar-label">
          <a href="/dsa">
            DSA
          </a>
        </span>
        <button id="toggleSidebar" class="text-white" onclick="toggleSidebar()">
          <!-- Icon for expanding/collapsing -->
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h7" />
          </svg>
        </button>
      </div>
      
      <!-- Menu Items -->
      <!-- Arrays -->
      <ul class="space-y-2">
        <li id="arrays" class="sidebar-item flex items-center space-x-2 parent" onclick="toggleChildMenu(this)">
          <span class="material-symbols-outlined">
            data_array
            </span>
          <span class="sidebar-label">Arrays</span>
        </li>
        <!-- Arrays childs -->
        <ul class="child-menu">
          <li id="bubble_sort" class="sidebar-item flex items-center space-x-2">
            <a href="?content=arrays&selected=bubble_sort" class="flex items-center space-x-2">
              <span class="sidebar-label">Bubble Sort</span>
            </a>
          </li>
          <li id="selection_sort" class="sidebar-item flex items-center space-x-2">
            <a href="?content=arrays&selected=selection_sort" class="flex items-center space-x-2">
              <span class="sidebar-label">Selection Sort</span>
            </a>
          </li>
<li id="insertion_sort" class="sidebar-item flex items-center space-x-2">
            <a href="?content=arrays&selected=insertion_sort" class="flex items-center space-x-2">
              <span class="sidebar-label">Insertion Sort</span>
            </a>
          </li>
        </ul>
<li id="quick_sort" class="sidebar-item flex items-center space-x-2">
            <a href="?content=arrays&selected=quick_sort" class="flex items-center space-x-2">
              <span class="sidebar-label">Quick Sort</span>
            </a>
          </li>
      </ul>
      
    </nav>

    <!-- Main Content -->
    <div id="contentArea" class="flex-grow p-10">
      <!-- Include essential content here -->
      <div id="dynamicContent">
        <p>Please select a section from the sidebar.</p>
      </div>
      <div id="code_editor" class="flex flex-row mt-5">
        <div id="editorContainer" class="basis-1" style="height: 500px; min-width: 60%;"></div>
        <button id="runCode" class="bg-gray-500 text-white basis-1/6 hover:bg-gray-700">Run Code</button>
        <div id="editorOutput" class="p-5 bg-gray-200 basis-1/2 wx-auto text-wrap"></div>
      </div>
    </div>
  </div>

  <script>
    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
  
      if (sidebar.classList.contains('expanded')) {
        sidebar.classList.remove('expanded');
        sidebar.classList.add('collapsed');
      } else {
        sidebar.classList.remove('collapsed');
        sidebar.classList.add('expanded');
      }
    }
  
    function toggleChildMenu(parentItem) {
      // Find the next sibling which is the child menu
      const childMenu = parentItem.nextElementSibling;
  
      // Toggle the display of the child menu
      if (childMenu && childMenu.classList.contains('child-menu')) {
        if (childMenu.style.display === 'block') {
          childMenu.style.display = 'none';
        } else {
          childMenu.style.display = 'block';
        }
      }
    }
  
    function highlightMenus() {
      // Extract query parameters
      const params = new URLSearchParams(window.location.search);
      const content = params.get('content');
      const selected = params.get('selected');
  
      if (content) {
        // Find and expand the parent menu
        const parentMenu = document.getElementById(content);
        if (parentMenu) {
          // Mark the parent menu as active and expand its child menu
          parentMenu.classList.add('parent-active');
          const childMenu = parentMenu.nextElementSibling;
          if (childMenu && childMenu.classList.contains('child-menu')) {
            childMenu.style.display = 'block';
          }
        }
  
        // Highlight the child menu if 'selected' parameter is available
        if (selected) {
          const childMenuItem = document.getElementById(selected);
          if (childMenuItem) {
            childMenuItem.classList.add('bg-gray-700', 'text-white'); // Add a class to highlight the child menu item
          }
        }
      }
    }
  
    function initializeMonacoEditor(htmlContent) {
      require.config({ paths: { 'vs': 'monaco-editor/min/vs' }});
      require(['vs/editor/editor.main'], function() {
        const editor = monaco.editor.create(document.getElementById('editorContainer'), {
          value: htmlContent,
          language: 'javascript',
          theme: 'vs-dark',
          automaticLayout: true
        });
  
        document.getElementById('runCode').addEventListener('click', () => {
          const code = editor.getValue();
          const outputDiv = document.getElementById('editorOutput');
  
          const originalConsole = { ...console };
          const output = [];
  
          function logToOutput(...args) {
            output.push(args.map(arg => typeof arg === 'object' ? JSON.stringify(arg, null, 2) : arg).join(' '));
            outputDiv.innerHTML = output.join('<br/>');
          }
  
          console.log = (...args) => logToOutput('>', ...args);
          console.error = (...args) => logToOutput('ERROR:', ...args);
          console.warn = (...args) => logToOutput('WARN:', ...args);
          console.info = (...args) => logToOutput('INFO:', ...args);
  
          try {
            outputDiv.innerHTML = '';
            const result = eval(code);
  
            if (result !== undefined) {
              outputDiv.innerHTML += `<br/><strong>Result:</strong> ${result}`;
            }
          } catch (error) {
            outputDiv.innerHTML += `<br/><strong>Error:</strong> ${error.message}`;
          }
  
          console.log = originalConsole.log;
          console.error = originalConsole.error;
          console.warn = originalConsole.warn;
          console.info = originalConsole.info;
        });
      });
    }
  
    function loadContent() {
      const params = new URLSearchParams(window.location.search);
      const content = params.get('content');
      const selected = params.get('selected');
      const file_path = `${content}/${selected}`;
      const contentArea = document.getElementById('dynamicContent');
  
      if (content && selected) {
        fetch(`data/${file_path}.xml`)
          .then(response => {
            if (!response.ok) {
              throw new Error('Network response was not ok');
            }
            return response.text();
          })
          .then(xmlText => {
            const parser = new DOMParser();
            const xmlDoc = parser.parseFromString(xmlText, 'application/xml');
  
            const nameElem = xmlDoc.querySelector('name');
            const descriptionElem = xmlDoc.querySelector('description');
            const scriptElem = xmlDoc.querySelector('script');
  
            contentArea.innerHTML = '';
  
            if (nameElem) {
              const name = nameElem.textContent;
              const nameDisplay = document.createElement('h2');
              nameDisplay.textContent = name;
              nameDisplay.className = 'text-xl font-bold';
              contentArea.appendChild(nameDisplay);
            }
  
            if (descriptionElem) {
              const description = descriptionElem.textContent;
              const descriptionDisplay = document.createElement('p');
              descriptionDisplay.textContent = description;
              contentArea.appendChild(descriptionDisplay);
            }
  
            if (scriptElem) {
              const scriptContent = scriptElem.textContent;
              initializeMonacoEditor(scriptContent);
            }
          })
          .catch(err => {
            contentArea.innerHTML = `<h2 class="text-xl font-bold">Error</h2><p>Content could not be loaded.</p>`;
            console.error('Error loading content:', err);
          });
      } else {
        document.getElementById('code_editor').remove();
        contentArea.innerHTML = `<h1 class="font-bold text-xl">Welcome coders</h1>`;
      }
    }
  
    window.onload = function() {
      loadContent();
      highlightMenus(); // Highlight the menus based on the query parameters
    };
  </script>
  

</body>

</html>
